# ุฑุงูููุง ฺฉุงูู ุงุชุตุงู Frontend ุจู Backend

## โ ฺฉุงุฑูุง ฺฉู ุงูุฌุงู ุดุฏู:

### 1. API Client (`src/lib/api.ts`)
- ฺฉูุงูุช ฺฉุงูู API ุจุฑุง ุชูุงู endpoints
- ูุฏุฑุช CSRF tokens
- ูุฏุฑุช ุฎุทุงูุง

### 2. Auth Context (`src/contexts/AuthContext.tsx`)
- ูุฏุฑุช state ุงุญุฑุงุฒ ููุช
- Login / Logout / Register
- ุจุฑุฑุณ ุฎูุฏฺฉุงุฑ ูุถุนุช ูุงฺฏู

### 3. ุตูุญุงุช ูุชุตู ุดุฏู:
- โ Login (`src/app/login/page.tsx`)
- โ Signup (`src/app/signup/page.tsx`)
- โ Dashboard (`src/app/dashboard/page.tsx`)
- โ Sidebar ุจุง logout (`src/components/layout/DashboardSidebar.tsx`)

## ๐ ุฑุงูโุงูุฏุงุฒ ุณุฑุน

### ูุฑุญูู 1: ุฑุงูโุงูุฏุงุฒ Backend

```bash
# Terminal 1 - Django Backend
cd D:\uiux\backend
.\venv\Scripts\Activate.ps1
python manage.py runserver
```

Backend ุฑู `http://localhost:8000` ุงุฌุฑุง ูโุดูุฏ.

### ูุฑุญูู 2: ุงุฌุงุฏ Admin

```bash
# ุฏุฑ ููุงู terminal backend
python manage.py createsuperuser

# ุงุทูุงุนุงุช ุฑุง ูุงุฑุฏ ฺฉูุฏ:
Username: admin
Email: admin@astrotunes.com
Password: (ุฑูุฒ ูู)
```

### ูุฑุญูู 3: ุฑุงูโุงูุฏุงุฒ Frontend

```bash
# Terminal 2 - Next.js Frontend
cd D:\uiux\astrotunes
npm run dev
```

Frontend ุฑู `http://localhost:3000` ุงุฌุฑุง ูโุดูุฏ.

## ๐ ุชุณุช ููู ฺฉุงูู

### ุชุณุช 1: ุซุจุช ูุงู ฺฉุงุฑุจุฑ ุฌุฏุฏ

1. ุจู `http://localhost:3000/signup` ุจุฑูุฏ
2. ูุฑู ุฑุง ูพุฑ ฺฉูุฏ:
   - ูุงู ููุฑ: (ุงุฎุชุงุฑ) ูุซู "ููุฑููุฏ ุชุณุช"
   - ุงูู: `test@example.com`
   - ุฑูุฒ ุนุจูุฑ: `test1234`
   - ุชฺฉุฑุงุฑ ุฑูุฒ ุนุจูุฑ: `test1234`
   - โ ููุงูู ุฑุง ุจูพุฐุฑุฏ
3. ุฑู "ุซุจุช ูุงู ุฑุงฺฏุงู" ฺฉูฺฉ ฺฉูุฏ
4. ุจุงุฏ ุจู ุฏุงุดุจูุฑุฏ ููุชูู ุดูุฏ

### ุชุณุช 2: ุจุฑุฑุณ ุฏุงุดุจูุฑุฏ

ูพุณ ุงุฒ ูุงฺฏูุ ุฏุฑ ุฏุงุดุจูุฑุฏ ุจุงุฏ ุจุจูุฏ:
- ูุงู ุดูุง ุฏุฑ ุนููุงู
- ูุถุนุช ุงุดุชุฑุงฺฉ: "ุฑุงฺฏุงู"
- ุชุนุฏุงุฏ ุชุฑฺฉโูุง: 0
- ูุถุนุช ุขูพููุฏ: "1 ุชุฑฺฉ ุฑุงฺฏุงู ุจุงูโูุงูุฏู"

### ุชุณุช 3: ุขูพููุฏ ุงููู ุชุฑฺฉ (ุฏุฑ ุญุงู ุชูุณุนู)

ุตูุญู ุขูพููุฏ ูููุฒ ุฏุฑ ุญุงู ุชูุณุนู ุงุณุช. ุจุฑุง ุชุณุช ุณุฑุน:

1. ุจู `http://localhost:8000/admin/` ุจุฑูุฏ
2. ุจุง ุงฺฉุงูุช admin login ฺฉูุฏ
3. ุงุฒ ููู `Tracks` ฺฉ ุชุฑฺฉ ุชุณุช ุงุฌุงุฏ ฺฉูุฏ:
   - User: ฺฉุงุฑุจุฑ ฺฉู ุณุงุฎุชุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
   - Title: "ุชุฑฺฉ ุชุณุช"
   - Release date: ุชุงุฑุฎ ุงูุฑูุฒ
   - ุจูู ููุฏูุง ุฑุง ูพุฑ ฺฉูุฏ
   - Status: "pending" ุจฺฏุฐุงุฑุฏ
4. ุฐุฎุฑู ฺฉูุฏ

### ุชุณุช 4: ุชุงุฏ ุชุฑฺฉ ุฏุฑ ูพูู Admin

1. ุฏุฑ ูพูู Admin Django ุฑู ุชุฑฺฉ ฺฉูฺฉ ฺฉูุฏ
2. Status ุฑุง ุจู "approved" ุชุบุฑ ุฏูุฏ
3. ุฐุฎุฑู ฺฉูุฏ
4. ุจู ุฏุงุดุจูุฑุฏ frontend ุจุฑฺฏุฑุฏุฏ
5. ุชุฑฺฉ ุดูุง ุจุงุฏ ุธุงูุฑ ุดูุฏ

### ุชุณุช 5: ุฎุฑุฏ ุงุดุชุฑุงฺฉ

#### ูุฑุญูู A: ุงุฌุงุฏ ุฑูุด ูพุฑุฏุงุฎุช (ุงฺฏุฑ ูุฌูุฏ ูุฏุงุฑุฏ)

ุฏุฑ ูพูู Admin Django:
1. `Payments > Payment methods > Add`
2. ุงุทูุงุนุงุช ฺฉุงุฑุช ุฑุง ูุงุฑุฏ ฺฉูุฏ:
   - Card number: `6037997123456789`
   - Card holder: `ุนู ุงุญูุฏ`
   - Bank: `ุจุงูฺฉ ูู`
   - โ Is active
3. ุฐุฎุฑู ฺฉูุฏ

#### ูุฑุญูู B: ุงุฌุงุฏ ูพุฑุฏุงุฎุช

1. ุฏุฑ ูพูู Admin Django: `Payments > Payments > Add payment`
2. ุงุทูุงุนุงุช ุฑุง ูุงุฑุฏ ฺฉูุฏ:
   - User: ฺฉุงุฑุจุฑ test
   - Subscription plan: "Professional"
   - Amount: 59900
   - Payment method: ุฑูุด ฺฉู ุณุงุฎุชุฏ
   - Transfer date: "1404/01/15"
   - Transfer time: "14:30"
   - Tracking code: "123456789"
   - Status: "pending"
3. ุฐุฎุฑู ฺฉูุฏ

#### ูุฑุญูู C: ุชุงุฏ ูพุฑุฏุงุฎุช

1. ุฏุฑ ูุณุช Payments ุฑู ูพุฑุฏุงุฎุช ฺฉู ุณุงุฎุชุฏ ฺฉูฺฉ ฺฉูุฏ
2. ุงุฒ dropdown "Action" ฺฏุฒูู "Approve payments" ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
3. ฺฉูฺฉ ุฑู "Go"
4. ุงุดุชุฑุงฺฉ ุฎูุฏฺฉุงุฑ ูุนุงู ูโุดูุฏ!

#### ูุฑุญูู D: ุจุฑุฑุณ ูุนุงู ุดุฏู ุงุดุชุฑุงฺฉ

1. ุจู ุฏุงุดุจูุฑุฏ frontend ุจุฑฺฏุฑุฏุฏ
2. ุฑูุฑุด ฺฉูุฏ
3. ูุถุนุช ุงุดุชุฑุงฺฉ ุจุงุฏ "ุญุฑููโุง" ููุงุด ุฏูุฏ
4. ูุถุนุช ุขูพููุฏ ุจุงุฏ "ูุงูุญุฏูุฏ" ุจุงุดุฏ

### ุชุณุช 6: Logout

1. ุฏุฑ sidebar ุฏฺฉูู "ุฎุฑูุฌ" ๐ช ุฑุง ฺฉูฺฉ ฺฉูุฏ
2. ุจุงุฏ ุจู ุตูุญู ุงุตู ููุชูู ุดูุฏ
3. ุฏุณุชุฑุณ ุจู `/dashboard` ูุจุงุฏ ุฏุงุดุชู ุจุงุดุฏ

## ๐ง ุตูุญุงุช ุฏุฑ ุญุงู ุชูุณุนู

ุงู ุตูุญุงุช ูููุฒ ุจู API ูุชุตู ูุดุฏูโุงูุฏ ู ูุงุฒ ุจู ุชฺฉูู ุฏุงุฑูุฏ:

### 1. ุตูุญู ุขูพููุฏ (`/dashboard/upload`)
- ูุฑู ฺฉุงูู ุขูพููุฏ ุชุฑฺฉ
- ุขูพููุฏ ูุงู ุตูุช ู ฺฉุงูุฑ
- ูุฏุฑุช ูุงู ููุฑ
- ุงุฑุณุงู ุจู backend

### 2. ุตูุญู ููุณู ูู (`/dashboard/music`)
- ูุณุช ุชูุงู ุชุฑฺฉโูุง ฺฉุงุฑุจุฑ
- ููุชุฑ ู ุฌุณุชุฌู
- ูุฑุงุด ุชุฑฺฉโูุง

### 3. ุตูุญู ุชูุธูุงุช (`/dashboard/settings`)
- ููุงุด ุทุฑุญโูุง ุงุดุชุฑุงฺฉ
- ูุฑู ูพุฑุฏุงุฎุช ฺฉุงุฑุช ุจู ฺฉุงุฑุช
- ุขูพููุฏ ุฑุณุฏ

### 4. ุตูุญู ฺฉู ูพูู (`/dashboard/wallet`)
- ููุงุด ุฏุฑุขูุฏ
- ุชูุธูุงุช ุขุฏุฑุณ USDT

## ๐ ูฺฉุงุช ููู

### 1. CSRF Token
Django ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ CSRF token ุงุฑุณุงู ูโฺฉูุฏ. ุฏุฑ API client ุงุฒ cookie ุงุณุชูุงุฏู ูโุดูุฏ:

```typescript
const csrfToken = getCookie('csrftoken');
if (csrfToken && options.method !== 'GET') {
  headers['X-CSRFToken'] = csrfToken;
}
```

### 2. Credentials
ููู ุฏุฑุฎูุงุณุชโูุง ุจุง `credentials: 'include'` ุงุฑุณุงู ูโุดููุฏ ุชุง session cookie ุงุฑุณุงู ุดูุฏ.

### 3. CORS
ุฏุฑ backend Djangoุ CORS ุจุฑุง `http://localhost:3000` ูุนุงู ุดุฏู ุงุณุช.

### 4. ูุงู ููุฑ
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ุฏุฑ signup ูุงู ููุฑ ูุงุฑุฏ ูฺฉูุฏุ ุฏุฑ ุงููู ุขูพููุฏ ุฏุฑุฎูุงุณุช ูโุดูุฏ
- ูพุณ ุงุฒ ุงููู ุขูพููุฏุ ูุงู ููุฑ ููู ูโุดูุฏ
- Backend ุงู ููู ุฑุง enforce ูโฺฉูุฏ

## ๐ ุฑูุน ูุดฺฉูุงุช ุฑุงุฌ

### ูุดฺฉู 1: CORS Error

**ุนูุช:** Backend ุงุฌุฑุง ูุดุฏู ุง CORS ุชูุธู ูุดุฏู

**ุฑุงู ุญู:**
```python
# ุฏุฑ backend/astrotunes_backend/settings.py
CORS_ALLOWED_ORIGINS = [
    "http://localhost:3000",
    "http://127.0.0.1:3000",
]
CORS_ALLOW_CREDENTIALS = True
```

### ูุดฺฉู 2: 403 Forbidden

**ุนูุช:** CSRF token ุงุฑุณุงู ูุดุฏู

**ุฑุงู ุญู:**
- ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู `credentials: 'include'` ุฏุฑ fetch ูุฌูุฏ ุฏุงุฑุฏ
- ุงููู ุจุงุฑ ุตูุญู ุฑุง reload ฺฉูุฏ ุชุง cookie ุฏุฑุงูุช ุดูุฏ

### ูุดฺฉู 3: User null ุงุณุช

**ุนูุช:** Session ูููุถ ุดุฏู ุง logout ุดุฏู

**ุฑุงู ุญู:**
- ุฏูุจุงุฑู login ฺฉูุฏ
- ุฏุฑ DevTools > Application > Cookies ุจุฑุฑุณ ฺฉูุฏ ฺฉู `sessionid` ูุฌูุฏ ุฏุงุฑุฏ

### ูุดฺฉู 4: ุขูพููุฏ ูุงู ฺฉุงุฑ ููโฺฉูุฏ

**ุนูุช:** Content-Type ุงุดุชุจุงู ุงุณุช

**ุฑุงู ุญู:**
```typescript
// ุจุฑุง FormDataุ Content-Type ุฑุง set ูฺฉูุฏ
// ูุฑูุฑฺฏุฑ ุฎูุฏฺฉุงุฑ multipart/form-data ูโูุฑุณุชุฏ
if (!(options.body instanceof FormData)) {
  headers['Content-Type'] = 'application/json';
}
```

## ๐ฆ API Endpoints ููุฌูุฏ

```
POST   /api/auth/register/         - ุซุจุช ูุงู
POST   /api/auth/login/            - ูุฑูุฏ
POST   /api/auth/logout/           - ุฎุฑูุฌ
GET    /api/auth/me/               - ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ูุนู
PUT    /api/auth/me/               - ูุฑุงุด ูพุฑููุงู
GET    /api/auth/check-artist-name/ - ุจุฑุฑุณ ูุงู ููุฑ

GET    /api/tracks/                - ูุณุช ุชุฑฺฉโูุง ฺฉุงุฑุจุฑ
POST   /api/tracks/                - ุขูพููุฏ ุชุฑฺฉ ุฌุฏุฏ
GET    /api/tracks/{id}/           - ุฌุฒุฆุงุช ฺฉ ุชุฑฺฉ
PUT    /api/tracks/{id}/           - ูุฑุงุด ุชุฑฺฉ
DELETE /api/tracks/{id}/           - ุญุฐู ุชุฑฺฉ
GET    /api/tracks/can_upload/     - ุจุฑุฑุณ ุงูฺฉุงู ุขูพููุฏ

GET    /api/subscription-plans/    - ูุณุช ุทุฑุญโูุง ุงุดุชุฑุงฺฉ
GET    /api/payment-methods/       - ุฑูุดโูุง ูพุฑุฏุงุฎุช ููุฌูุฏ
GET    /api/current-subscription/  - ุงุดุชุฑุงฺฉ ูุนู ฺฉุงุฑุจุฑ
POST   /api/payments/payments/     - ุซุจุช ูพุฑุฏุงุฎุช ุฌุฏุฏ
GET    /api/payments/payments/     - ูุณุช ูพุฑุฏุงุฎุชโูุง ฺฉุงุฑุจุฑ
```

## ๐ฏ ุจุนุฏ ฺุณุชุ

1. **ุชฺฉูู ุตูุญู ุขูพููุฏ**: ูุงู `page_connected.tsx` ุฑุง ุจุง ูุฑู ฺฉุงูู replace ฺฉูุฏ
2. **ุตูุญู ููุณู ูู**: ููุงุด ูุณุช ุชุฑฺฉโูุง ุจุง pagination
3. **ุตูุญู ุชูุธูุงุช**: ูพุฑุฏุงุฎุช ุงุดุชุฑุงฺฉ ุจุง ฺฉุงุฑุช ุจู ฺฉุงุฑุช
4. **ุตูุญู ฺฉู ูพูู**: ูุฏุฑุช ุฏุฑุขูุฏ ู ุจุฑุฏุงุดุช

ููู ฺุฒ ุขูุงุฏู ุงุณุช! Backend ฺฉุงุฑ ูโฺฉูุฏ ู Frontend ุจุง API ุงุฑุชุจุงุท ุฏุงุฑุฏ. โ

